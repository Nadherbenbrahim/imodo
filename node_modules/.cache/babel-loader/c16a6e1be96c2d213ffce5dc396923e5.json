{"ast":null,"code":"import axios from 'axios';\nimport { host, trainAgentHost } from '../../config';\nexport const answerComment = (Page, project, comment, answer) => {\n  return dispatch => {\n    // console.log(\"Get from here\", project);\n    let objectToSend = {\n      logs: comment,\n      answer: answer,\n      project: project\n    };\n    console.log(\"im sending answerComment to nour\", objectToSend);\n    return axios.post(host + `/api/v1/secure/logEvent/answer/comment/${Page.platform}`, objectToSend, {\n      headers: {\n        'authorization': 'Bearer ' + localStorage.getItem('authtoken')\n      }\n    }) // .then(res => {\n    //     console.log('answerComment post APi Response =>', res.data.data);\n    // })\n    .catch(err => console.log(\"answerComment post Api error  =>\", err));\n  };\n};\nexport const getLogs = (idPostOrPage, Page) => {\n  return dispatch => {\n    // console.log(\"Get from here\", project);\n    return axios.get(host + `/api/v1/secure/logEvent/post/${idPostOrPage}/all`, {\n      headers: {\n        'authorization': 'Bearer ' + localStorage.getItem('authtoken')\n      }\n    }).then(res => {\n      console.log('getLogs post APi Response =>', res.data.data);\n      let commentsMatched = [];\n      let commentsNotMatched = [];\n\n      if (res.data.data[0].events) {\n        console.log(\"Seeing Events ....\");\n        res.data.data[0].events.map(comment => {\n          axios.get(`https://graph.facebook.com/v8.0/${comment.publisher.id}?fields=gender,birthday,address,email,first_name,last_name,location,picture{url}&access_token=${Page.accessToken}`).then(res => {\n            // console.log(\"Facebook\", res.data);\n            comment.publisher.socialMediaData = res.data;\n          }).catch(errFb => {\n            console.log(\"Fb error my agents get Logs\", errFb);\n            comment.publisher.socialMediaData = {\n              first_name: '',\n              gender: '',\n              id: '',\n              last_name: '',\n              picture: {\n                data: {\n                  url: ''\n                }\n              }\n            };\n          });\n\n          if (comment.success) {\n            commentsMatched.push(comment);\n          } else {\n            // comment.publisher.socialMediaData = res.data\n            commentsNotMatched.push(comment);\n          }\n        });\n        console.log(\"Matched =>\", commentsMatched);\n        console.log(\"Not Matched =>\", commentsNotMatched);\n      }\n\n      dispatch({\n        type: 'GET_LOGS_BY_PAGE',\n        payload: res.data.data,\n        payload1: commentsMatched,\n        payload2: commentsNotMatched\n      });\n    }).catch(err => console.log(\"getLogs post Api error  =>\", err));\n  };\n};\nexport const deleteProjectByPage = projet => {\n  return dispatch => {\n    let objectToSend = {\n      project: projet\n    };\n    return axios.put(host + `/api/v1/secure/project/remove/project`, objectToSend, {\n      headers: {\n        'authorization': 'Bearer ' + localStorage.getItem('authtoken')\n      }\n    }).then(res => {\n      console.log('deleteProjectByPage post APi Response =>', res.data.data);\n      dispatch({\n        type: 'GET_PROJECT_BY_PAGE',\n        payload: res.data.data\n      });\n    }).catch(err => console.log(\"deleteProjectByPage post Api error  =>\", err));\n  };\n};\nexport const goToWizardConfig = (projet, Page, history) => {\n  return dispatch => {\n    // Detect intent Type \n    let intentDetection = projet.post.idPost === projet.post.page.idPage; // Because in the wizard it's id not idPost :D sorry for that\n\n    projet.post.id = projet.post.idPost;\n    dispatch({\n      type: 'FROM_MY_AGENTS_TO_STEP_3_WIZARD',\n      payload: 2,\n      payload1: projet._id,\n      payload2: intentDetection ? \"generic\" : \"default\",\n      payload3: Page,\n      payload4: projet.post\n    });\n    history.push('/home/auto-wizard');\n    dispatch({\n      type: 'SELECT_WIZARD_PAGE',\n      payload: Page\n    });\n  };\n};\nexport const setAgentsSelectedProject = (project, history) => {\n  return dispatch => {\n    dispatch({\n      type: 'SET_AGENTS_PROJECT',\n      payload: project\n    });\n    history.push('/home/my-agents-messages');\n  };\n};\nexport const getProjectByPage = Page => {\n  return dispatch => {\n    return axios.get(host + `/api/v1/secure/pages/get/project/${Page.id}`, {\n      headers: {\n        'authorization': 'Bearer ' + localStorage.getItem('authtoken')\n      }\n    }).then(res => {\n      console.log('getProjectByPage post APi Response =>', res.data.data);\n      dispatch({\n        type: 'GET_PROJECT_BY_PAGE',\n        payload: res.data.data\n      });\n    }).catch(err => console.log(\"getProjectByPage post Api error  =>\", err));\n  };\n};","map":{"version":3,"sources":["/usr/work/smart_front_oussema/src/redux/actions/myAgentsActions.js"],"names":["axios","host","trainAgentHost","answerComment","Page","project","comment","answer","dispatch","objectToSend","logs","console","log","post","platform","headers","localStorage","getItem","catch","err","getLogs","idPostOrPage","get","then","res","data","commentsMatched","commentsNotMatched","events","map","publisher","id","accessToken","socialMediaData","errFb","first_name","gender","last_name","picture","url","success","push","type","payload","payload1","payload2","deleteProjectByPage","projet","put","goToWizardConfig","history","intentDetection","idPost","page","idPage","_id","payload3","payload4","setAgentsSelectedProject","getProjectByPage"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport { host,trainAgentHost } from '../../config';\r\n\r\n\r\n\r\nexport const answerComment = (Page,project,comment,answer) => {\r\n    return (dispatch) => {\r\n        // console.log(\"Get from here\", project);\r\n    \r\n        let objectToSend = {\r\n            logs: comment,\r\n            answer: answer,\r\n            project: project, \r\n        };\r\n\r\n        console.log(\"im sending answerComment to nour\", objectToSend);\r\n\r\n        return axios.post(host + `/api/v1/secure/logEvent/answer/comment/${Page.platform}`,objectToSend,{\r\n            headers: {\r\n                'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n            }\r\n        })\r\n        // .then(res => {\r\n        //     console.log('answerComment post APi Response =>', res.data.data);\r\n        // })\r\n        .catch((err) => console.log(\"answerComment post Api error  =>\", err))\r\n    }\r\n};\r\n\r\nexport const getLogs = (idPostOrPage,Page) => {\r\n    return (dispatch) => {\r\n        // console.log(\"Get from here\", project);\r\n\r\n\r\n        return axios.get(host + `/api/v1/secure/logEvent/post/${idPostOrPage}/all`,{\r\n            headers: {\r\n                'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n            }\r\n        })\r\n        .then(res => {\r\n            console.log('getLogs post APi Response =>', res.data.data);\r\n\r\n            let commentsMatched = [];\r\n            let commentsNotMatched = []; \r\n\r\n            if(res.data.data[0].events) {\r\n                console.log(\"Seeing Events ....\");\r\n                res.data.data[0].events.map(comment => {\r\n                    axios.get(`https://graph.facebook.com/v8.0/${comment.publisher.id}?fields=gender,birthday,address,email,first_name,last_name,location,picture{url}&access_token=${Page.accessToken}`)\r\n                    .then((res) => {\r\n                        // console.log(\"Facebook\", res.data);\r\n                        comment.publisher.socialMediaData = res.data\r\n                    })\r\n                    .catch((errFb) => {\r\n                        console.log(\"Fb error my agents get Logs\", errFb);\r\n                        comment.publisher.socialMediaData = {\r\n                            first_name: '',\r\n                            gender: '',\r\n                            id: '',\r\n                            last_name: '',\r\n                            picture: {\r\n                                data: {\r\n                                    url: ''\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                    \r\n                    if(comment.success) {\r\n                        commentsMatched.push(comment);\r\n                    } else {\r\n                        // comment.publisher.socialMediaData = res.data\r\n                        commentsNotMatched.push(comment);\r\n                    }\r\n                });\r\n\r\n                console.log(\"Matched =>\", commentsMatched)\r\n                console.log(\"Not Matched =>\", commentsNotMatched)\r\n            }\r\n\r\n            dispatch({\r\n                type: 'GET_LOGS_BY_PAGE',\r\n                payload: res.data.data,\r\n                payload1: commentsMatched,\r\n                payload2: commentsNotMatched,\r\n            });\r\n            \r\n        })\r\n        .catch((err) => console.log(\"getLogs post Api error  =>\", err))\r\n    }\r\n};\r\n\r\nexport const deleteProjectByPage = (projet) => {\r\n    return (dispatch) => {\r\n\r\n        let objectToSend = {\r\n            project: projet,\r\n        };\r\n\r\n        return axios.put(host + `/api/v1/secure/project/remove/project`,objectToSend,{\r\n            headers: {\r\n                'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n            }\r\n        })\r\n        .then(res => {\r\n            console.log('deleteProjectByPage post APi Response =>', res.data.data);\r\n\r\n            dispatch({\r\n                type: 'GET_PROJECT_BY_PAGE',\r\n                payload: res.data.data,\r\n            });\r\n        })\r\n        .catch((err) => console.log(\"deleteProjectByPage post Api error  =>\", err) )\r\n    }\r\n};\r\n\r\nexport const goToWizardConfig = (projet,Page,history) => {\r\n    return (dispatch) => {\r\n        // Detect intent Type \r\n        let intentDetection = projet.post.idPost === projet.post.page.idPage;\r\n\r\n        // Because in the wizard it's id not idPost :D sorry for that\r\n        projet.post.id = projet.post.idPost;\r\n\r\n        dispatch({\r\n            type: 'FROM_MY_AGENTS_TO_STEP_3_WIZARD',\r\n            payload: 2,\r\n            payload1: projet._id,\r\n            payload2: intentDetection ? \"generic\" : \"default\",\r\n            payload3: Page,\r\n            payload4: projet.post,\r\n        });\r\n\r\n        history.push('/home/auto-wizard');\r\n\r\n        dispatch({\r\n            type: 'SELECT_WIZARD_PAGE', \r\n            payload: Page,\r\n        });\r\n    }\r\n};\r\n\r\n\r\n\r\nexport const setAgentsSelectedProject = (project,history) => {\r\n    return (dispatch) => {\r\n \r\n        dispatch({\r\n            type: 'SET_AGENTS_PROJECT',\r\n            payload: project,\r\n        });\r\n       \r\n        history.push('/home/my-agents-messages');\r\n    }\r\n};\r\n\r\nexport const getProjectByPage = (Page) => {\r\n    return (dispatch) => {\r\n \r\n        return axios.get(host + `/api/v1/secure/pages/get/project/${Page.id}`,{\r\n            headers: {\r\n                'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n            }\r\n        })\r\n        .then(res => {\r\n            console.log('getProjectByPage post APi Response =>', res.data.data);\r\n\r\n            dispatch({\r\n                type: 'GET_PROJECT_BY_PAGE',\r\n                payload: res.data.data,\r\n            });\r\n        })\r\n        .catch((err) => console.log(\"getProjectByPage post Api error  =>\", err) )\r\n    }\r\n};"]},"metadata":{},"sourceType":"module"}