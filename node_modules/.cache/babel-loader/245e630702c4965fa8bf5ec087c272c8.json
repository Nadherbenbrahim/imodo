{"ast":null,"code":"import _regeneratorRuntime from\"/usr/work/smart_front_oussema/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/usr/work/smart_front_oussema/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/usr/work/smart_front_oussema/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'./Login.css';import{FacebookProvider,LoginButton}from'react-facebook';import axios from'axios';import{host}from'../../config';import Swal from'sweetalert2/dist/sweetalert2.js';import{Redirect,useParams}from\"react-router-dom\";function Facebook(props){var content=props.content,type=props.type;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),redirect=_useState2[0],setRedirect=_useState2[1];var _useParams=useParams(),tokenMembership=_useParams.tokenMembership;// Popup config\nvar swalWithBootstrapButtons=Swal.mixin({customClass:{confirmButton:'wizard-pages-active-btn-alert'},buttonsStyling:false});var handleResponse=function handleResponse(data){var token=data.tokenDetail.accessToken;var tokenMemberShip=tokenMembership?tokenMembership:null;axios.post(host+'/api/v1/auth/login/facebook',{token:token,tokenMemberShip:tokenMemberShip}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var objectToStore;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('Login =>',res.data.data);objectToStore={token:res.data.data.token,user:{access_token:res.data.data.user.access_token,create_at:res.data.data.user.create_at,email:res.data.data.user.email,first_name:res.data.data.user.first_name,idFacebook:res.data.data.user.idFacebook,isConnected:res.data.data.user.isConnected,last_name:res.data.data.user.last_name,last_signin:res.data.data.user.last_signin,profilePictureUrl:res.data.data.user.profilePictureUrl}};_context.next=4;return localStorage.setItem('authtoken',res.data.data.user.idFacebook);case 4:_context.next=6;return localStorage.setItem('userData',JSON.stringify(objectToStore));case 6:setRedirect(true);case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){console.log(\"Login Error =>\",err);swalWithBootstrapButtons.fire({icon:'error',title:'Connexion error with the server try again !',confirmButtonText:'Okay'});});};var handleError=function handleError(error){console.log(error);};return/*#__PURE__*/React.createElement(React.Fragment,null,redirect&&/*#__PURE__*/React.createElement(Redirect,{to:\"/home/pages\"}),/*#__PURE__*/React.createElement(FacebookProvider,{appId:\"783983335073350\",version:\"v3.0\"},/*#__PURE__*/React.createElement(LoginButton,{scope:\"public_profile,publish_pages,email,pages_messaging,pages_manage_cta,pages_show_list,manage_pages,instagram_basic,instagram_manage_comments,ads_management,ads_read\",onCompleted:handleResponse,onError:handleError,className:type===\"nav\"?\"facebookbtn\":type===\"signUp\"?\"button-free-trial\":\"facebookbtnLanding\"},/*#__PURE__*/React.createElement(\"span\",null,content))));}export default Facebook;","map":{"version":3,"sources":["/usr/work/smart_front_oussema/src/app/Login/Facebook.js"],"names":["React","useEffect","useState","FacebookProvider","LoginButton","axios","host","Swal","Redirect","useParams","Facebook","props","content","type","redirect","setRedirect","tokenMembership","swalWithBootstrapButtons","mixin","customClass","confirmButton","buttonsStyling","handleResponse","data","token","tokenDetail","accessToken","tokenMemberShip","post","then","res","console","log","objectToStore","user","access_token","create_at","email","first_name","idFacebook","isConnected","last_name","last_signin","profilePictureUrl","localStorage","setItem","JSON","stringify","catch","err","fire","icon","title","confirmButtonText","handleError","error"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './Login.css';\nimport { FacebookProvider, LoginButton } from 'react-facebook';\nimport axios from 'axios';\nimport { host } from '../../config';\nimport Swal from 'sweetalert2/dist/sweetalert2.js';\n\n\nimport {\n  Redirect,\n  useParams,\n} from \"react-router-dom\";\n\nfunction Facebook(props) {\n\n  let {\n    content,\n    type,\n  } = props;\n\n  const [redirect, setRedirect] = useState(false);\n  let { tokenMembership } = useParams();\n  \n  // Popup config\n  const swalWithBootstrapButtons = Swal.mixin({\n    customClass: {\n      confirmButton: 'wizard-pages-active-btn-alert',\n    },\n    buttonsStyling: false\n  });\n\n\n\n  const handleResponse = (data) => {\n    \n    let token = data.tokenDetail.accessToken;\n    let tokenMemberShip = tokenMembership ? tokenMembership : null;\n\n    axios.post(host + '/api/v1/auth/login/facebook', {\n        token,\n        tokenMemberShip\n    }).then( async res => {\n      console.log('Login =>', res.data.data);\n\n      let objectToStore = {\n        token : res.data.data.token,\n        user : {\n          access_token: res.data.data.user.access_token ,\n          create_at: res.data.data.user.create_at,\n          email:res.data.data.user.email,\n          first_name: res.data.data.user.first_name,\n          idFacebook:res.data.data.user.idFacebook,\n          isConnected:res.data.data.user.isConnected,\n          last_name:res.data.data.user.last_name,\n          last_signin: res.data.data.user.last_signin,\n          profilePictureUrl: res.data.data.user.profilePictureUrl,\n        },\n      }\n      \n      await localStorage.setItem('authtoken', res.data.data.user.idFacebook)\n      await localStorage.setItem('userData',JSON.stringify(objectToStore));\n      setRedirect(true);\n    }).catch((err) => {\n      console.log(\"Login Error =>\", err)\n      swalWithBootstrapButtons.fire({\n        icon: 'error',\n        title: 'Connexion error with the server try again !',\n        confirmButtonText: 'Okay',\n      });\n    })\n\n  };\n\n\n  const handleError = (error) => {\n    console.log(error);\n  }\n\n  return (\n    <>\n      { redirect && <Redirect to=\"/home/pages\" /> }\n\n      <FacebookProvider appId=\"783983335073350\" version=\"v3.0\">\n        <LoginButton\n          scope=\"public_profile,publish_pages,email,pages_messaging,pages_manage_cta,pages_show_list,manage_pages,instagram_basic,instagram_manage_comments,ads_management,ads_read\"\n          onCompleted={handleResponse}\n          onError={handleError}\n          \n          className={type === \"nav\" ? \"facebookbtn\" : type===\"signUp\" ? \"button-free-trial\" :  \"facebookbtnLanding\" }\n        >\n          <span>{content}</span>\n        </LoginButton>\n      </FacebookProvider>\n    </>\n  );\n}\n\nexport default Facebook;\n"]},"metadata":{},"sourceType":"module"}