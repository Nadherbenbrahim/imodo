{"ast":null,"code":"import _slicedToArray from\"/usr/work/smart_front_oussema/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import Pages from'../Pages/Pages';import{Col,Row,Image,Modal}from'react-bootstrap';import ReactTooltip from'react-tooltip';import moment from'moment';import axios from'axios';import{host}from'../../../config';import Swal from'sweetalert2/dist/sweetalert2.js';import Lottie from'react-lottie';import{useHistory,useLocation}from'react-router-dom';import{connect}from'react-redux';import{resetSocialMediaSelections,sycroPageWithWizard}from'../../../redux/actions/socialMediaActions';import{resetَAllWizard}from'../../../redux/actions/wizardActions';import{getProjectByPage,goToWizardConfig,deleteProjectByPage,setAgentsSelectedProject,resetLogs}from'../../../redux/actions/myAgentsActions';// Translations\nimport{trans}from'../../../Translations';import notFoundAnimationData from'../../../assets/json/not-found.json';import{FaLink}from'react-icons/fa';import{AiFillPicture}from'react-icons/ai';import{BiError}from'react-icons/bi';import{IoIosClose}from'react-icons/io';import{FaInfoCircle}from'react-icons/fa';var EDIT_ICON=require('../../../assets/images/home/Icon feather-edit.svg');var MSG_ICON=require('../../../assets/images/home/Icon feather-message-square.svg');var TRASH_ICON=require('../../../assets/images/home/trash-simple.svg');function MyAgents(props){var lang=props.lang,allSocialPages=props.allSocialPages,socialMediaPageSelected=props.socialMediaPageSelected,agentsProjects=props.agentsProjects,sycroPageWithWizard=props.sycroPageWithWizard,resetَAllWizard=props.resetَAllWizard,resetSocialMediaSelections=props.resetSocialMediaSelections,resetLogs=props.resetLogs,getProjectByPage=props.getProjectByPage,goToWizardConfig=props.goToWizardConfig,deleteProjectByPage=props.deleteProjectByPage,setAgentsSelectedProject=props.setAgentsSelectedProject;// Popup Config:\nvar swalWithBootstrapButtons=Swal.mixin({customClass:{confirmButton:'wizard-pages-active-btn-alert'},buttonsStyling:false});var notFoundOptions={loop:true,autoplay:true,animationData:notFoundAnimationData,rendererSettings:{preserveAspectRatio:'xMidYMid slice'}};var history=useHistory();var location=useLocation();// const tableTitles = ['Picture', 'Publish', 'Message', 'Date', 'Last update', 'Type', 'Status', 'Edit project'];\n// State :\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),deleteProjectModal=_useState2[0],setDeleteProjectModal=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),projectToDelete=_useState4[0],setProjectToDelete=_useState4[1];// const [activatingProject, setActivatingProject] = useState({status: \"\", index: null});\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showPopover=_useState6[0],setShowPopover=_useState6[1];var confirmDeleteModal=function confirmDeleteModal(){return/*#__PURE__*/React.createElement(Modal,{show:deleteProjectModal,centered:true},/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(IoIosClose,{color:\"#B4B4B4\",size:30,className:\"ml-auto\",style:{cursor:'pointer'},onClick:function onClick(){setProjectToDelete({});setDeleteProjectModal(false);}})),/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(BiError,{color:\"#E5007D\",size:65,className:\"mx-auto mb-3\",style:{cursor:'pointer'}})),/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"p\",{className:\"mx-auto mb-2 confirm-modal-text\"},trans[lang].myAgents.deleteProject)),/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mx-auto mb-3 manage-products-add-btn d-flex text-center\",onClick:function onClick(){return deleteProjectByPage(projectToDelete).then(function(){setProjectToDelete({});setDeleteProjectModal(false);});}},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},trans[lang].myAgents.confirmDelete))),/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"p\",{className:\"mx-auto mb-2 cancel-btn-modal-text\",onClick:function onClick(){setProjectToDelete({});setDeleteProjectModal(false);}},trans[lang].myAgents.rejectDelete))))));};var renderDate=function renderDate(date){return moment(date).format('DD/MM/YY');};var renderTime=function renderTime(date){return moment(date).format('h:mm');};var checkStatusClass=function checkStatusClass(trained,live){if(trained&&live){// ACTIVE\nreturn\"my-agent-status-btn d-flex\";}else if(trained&&!live){// !NOT ACTIVE\nreturn\"my-agent-status-btn d-flex\";}else{// DRAFT\nreturn\"my-agent-status-btn-disabled d-flex\";}};var activateAgentNow=function activateAgentNow(project,indexProject){// console.log(\"To Activate that =>\", project);\nif(project.trained&&project.live){// MAKE IT NOT ACTIVE\nvar objectToSend={live:false};axios.put(host+\"/api/v1/secure/project/agent/live/\".concat(project._id),objectToSend,{headers:{'authorization':'Bearer '+localStorage.getItem('authtoken')}}).then(function(res){console.log('agent Later post APi Response =>',res.data.data);getProjectByPage(socialMediaPageSelected);}).catch(function(err){console.log(\"agent Later post Api error  =>\",err);swalWithBootstrapButtons.fire({title:\"Error while activating agent. Try Again !\",confirmButtonText:'Okay'});});}else if(project.trained&&!project.live){// ACTIVATE IT\nvar _objectToSend={live:true};axios.put(host+\"/api/v1/secure/project/agent/live/\".concat(project._id),_objectToSend,{headers:{'authorization':'Bearer '+localStorage.getItem('authtoken')}}).then(function(res){console.log('My agents agent/live post APi Response =>',res.data.data);getProjectByPage(socialMediaPageSelected);}).catch(function(err){console.log(\"My agents agent/live Api error  =>\",err);swalWithBootstrapButtons.fire({title:\"Error while activating agent. Try Again !\",confirmButtonText:'Okay'});});}else{// DRAFT\nreturn;}};var renderPopover=function renderPopover(){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex manage-products-popover\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},trans[lang].myAgents.infoPopover));};var handlePopover=function handlePopover(delay){setTimeout(function(){setShowPopover(!showPopover);},delay);};useEffect(function(){resetَAllWizard();resetLogs();if(location.state){if(location.state.hasOwnProperty('imFrom')&&location.state.hasOwnProperty('page')&&allSocialPages){// Sync with the wizard page\n// console.log(\"Lets syncro with the wizard :D\", location.state);\nsycroPageWithWizard(allSocialPages,location.state.page);}}},[]);useEffect(function(){if(socialMediaPageSelected){getProjectByPage(socialMediaPageSelected);}},[socialMediaPageSelected]);return/*#__PURE__*/React.createElement(\"div\",{style:{height:window.innerHeight*2,marginTop:'135px'}},deleteProjectModal&&confirmDeleteModal(),/*#__PURE__*/React.createElement(Row,{className:\"mt-5\"},/*#__PURE__*/React.createElement(\"p\",{className:\"home-big-title\"},trans[lang].myAgents.title),/*#__PURE__*/React.createElement(FaInfoCircle,{style:{transitionDuration:'300ms'},color:!showPopover?\"#4080FF\":\"#E5007D\",size:'15',onMouseEnter:function onMouseEnter(){return handlePopover('20');},onMouseLeave:function onMouseLeave(){return handlePopover('300');}}),showPopover&&renderPopover()),/*#__PURE__*/React.createElement(Pages,{title:trans[lang].myAgents.smallTitle}),props.socialMediaPageSelected&&agentsProjects&&agentsProjects.length>0?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,{className:\"mb-2 mx-0\"},/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex mb-0\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto my-agent-table-title\"},trans[lang].myAgents.projectList)),/*#__PURE__*/React.createElement(Col,{lg:11,className:\"my-3 mx-0 p-0\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:12,className:\"pl-4 pr-5 py-4\",style:{background:\"#FFFFFF\"}},/*#__PURE__*/React.createElement(Row,{className:\"py-2 justify-content-between\"},trans[lang].myAgents.tableTitles.map(function(title,index){return/*#__PURE__*/React.createElement(Col,{lg:title===\"Status\"||title===\"Message\"||title===\"Statut\"?2:1,key:index,className:\"d-flex p-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"m-auto my-agent-title-table\"},title));})),agentsProjects&&agentsProjects.map(function(project,indexProject){return project.hasOwnProperty('intents')&&project.intents.length>0&&/*#__PURE__*/React.createElement(Row,{key:indexProject,className:\"py-2 justify-content-between\"},/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},project.post.picture?/*#__PURE__*/React.createElement(Image,{src:project.post.picture,className:\"m-auto\",style:{height:'40px',width:'40px'}}):/*#__PURE__*/React.createElement(Image,{src:socialMediaPageSelected.picture_url,className:\"m-auto\",style:{height:'40px',width:'40px',borderRadius:'50%'}})),/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},project.post.published?/*#__PURE__*/React.createElement(\"div\",{className:\"flex-column\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-date\",style:{color:project.post.status===\"Scheduled\"?\"#009EE3\":\"#4D4F5C\"}},renderDate(project.post.published)),/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-time\",style:{color:project.post.status===\"Scheduled\"?\"#009EE3\":\"#4D4F5C\"}},renderTime(project.post.published))):/*#__PURE__*/React.createElement(\"p\",{className:\"mx-auto my-agent-project-date\"},\"--.--\")),/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex p-0\"},project.post.message?/*#__PURE__*/React.createElement(\"div\",{className:\"m-auto my-agents-msg-desc\"},project.post.message.length>12?project.post.message.substring(0,40)+\"...\":project.post.message):/*#__PURE__*/React.createElement(\"p\",{className:\"mx-auto my-agent-project-date\"},\"--.--\")),/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-column\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-date\"},renderDate(project.createDate)),/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-time\"},renderTime(project.createDate)))),/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-column\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-date\"},renderDate(project.lastUpdate)),/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto my-agent-project-time\"},renderTime(project.lastUpdate)))),/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"m-auto wizard-pages-page-title-table\"},project.post.idPost===project.post.page.idPage?/*#__PURE__*/React.createElement(FaLink,{color:project.post.published!=null?\"#B4B4B4\":\"#85ADFF\",size:\"22\",className:\"m-auto\"}):/*#__PURE__*/React.createElement(AiFillPicture,{color:project.post.published!=null?\"#B4B4B4\":\"#85ADFF\",size:\"22\",className:\"m-auto\"}))),/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:checkStatusClass(project.trained,project.live),onClick:function onClick(){return activateAgentNow(project,indexProject);},style:{margin:'auto'}},project.trained&&project.live?/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},\"Active\"):project.trained&&!project.live?/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},\"Not Active\"):/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},\"Draft\"))),/*#__PURE__*/React.createElement(Col,{lg:1,className:\"d-flex\"},/*#__PURE__*/React.createElement(Image,{src:EDIT_ICON,\"data-for\":\"editIcon\",\"data-tip\":\"Update agent\",className:\"my-auto ml-auto my-agents-icon\",style:{height:'19px',width:'19px'},onClick:function onClick(){return goToWizardConfig(project,socialMediaPageSelected,history);}}),/*#__PURE__*/React.createElement(Image,{src:MSG_ICON,\"data-for\":\"commentsIcon\",\"data-tip\":project.logs===1?trans[lang].myAgents.checkComments:trans[lang].myAgents.noLogs,className:\"mx-2 my-auto my-agents-icon\",style:{height:'19px',width:'19px'},onClick:function onClick(){return project.logs===1&&setAgentsSelectedProject(project,history);}}),/*#__PURE__*/React.createElement(Image,{src:TRASH_ICON,\"data-for\":\"deleteIcon\",\"data-tip\":\"Delete agent\",className:\"my-auto mr-auto my-agents-icon\",style:{height:'19px',width:'19px'},onClick:function onClick(){setProjectToDelete(project);setDeleteProjectModal(true);}}),/*#__PURE__*/React.createElement(ReactTooltip,{id:\"editIcon\",className:\"my-agent-icons-hover-text\",textColor:\"#fff\",backgroundColor:\"#B4B4B4\"}),/*#__PURE__*/React.createElement(ReactTooltip,{id:\"commentsIcon\",className:\"my-agent-icons-hover-text\",textColor:\"#fff\",backgroundColor:\"#B4B4B4\"}),/*#__PURE__*/React.createElement(ReactTooltip,{id:\"deleteIcon\",className:\"my-agent-icons-hover-text\",textColor:\"#fff\",backgroundColor:\"#B4B4B4\"})));})))))))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\",style:{backgroundColor:'#F9F9F9'}},/*#__PURE__*/React.createElement(Lottie,{options:notFoundOptions,width:200,className:\"m-auto\"/*height={400}*/})),/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex mt-5\",style:{backgroundColor:'#F9F9F9'}},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto home-big-title\"},trans[lang].myAgents.noAgents))));};var mapStateToProps=function mapStateToProps(state){return{lang:state.socialMediaR.lang,fbData:state.socialMediaR.fbData,instaData:state.socialMediaR.instaData,allSocialPages:state.socialMediaR.allSocialPages,socialMediaPageSelected:state.socialMediaR.socialMediaPageSelected,agentsProjects:state.agentsR.agentsProjects,agentsSelectedProject:state.agentsR.agentsSelectedProject};};export default connect(mapStateToProps,{resetSocialMediaSelections:resetSocialMediaSelections,sycroPageWithWizard:sycroPageWithWizard,getProjectByPage:getProjectByPage,goToWizardConfig:goToWizardConfig,resetَAllWizard:resetَAllWizard,deleteProjectByPage:deleteProjectByPage,setAgentsSelectedProject:setAgentsSelectedProject,resetLogs:resetLogs})(MyAgents);","map":{"version":3,"sources":["/usr/work/smart_front_oussema/src/app/Home/MyAgents/MyAgents.js"],"names":["React","useEffect","useState","Pages","Col","Row","Image","Modal","ReactTooltip","moment","axios","host","Swal","Lottie","useHistory","useLocation","connect","resetSocialMediaSelections","sycroPageWithWizard","resetَAllWizard","getProjectByPage","goToWizardConfig","deleteProjectByPage","setAgentsSelectedProject","resetLogs","trans","notFoundAnimationData","FaLink","AiFillPicture","BiError","IoIosClose","FaInfoCircle","EDIT_ICON","require","MSG_ICON","TRASH_ICON","MyAgents","props","lang","allSocialPages","socialMediaPageSelected","agentsProjects","swalWithBootstrapButtons","mixin","customClass","confirmButton","buttonsStyling","notFoundOptions","loop","autoplay","animationData","rendererSettings","preserveAspectRatio","history","location","deleteProjectModal","setDeleteProjectModal","projectToDelete","setProjectToDelete","showPopover","setShowPopover","confirmDeleteModal","cursor","myAgents","deleteProject","then","confirmDelete","rejectDelete","renderDate","date","format","renderTime","checkStatusClass","trained","live","activateAgentNow","project","indexProject","objectToSend","put","_id","headers","localStorage","getItem","res","console","log","data","catch","err","fire","title","confirmButtonText","renderPopover","infoPopover","handlePopover","delay","setTimeout","state","hasOwnProperty","page","height","window","innerHeight","marginTop","transitionDuration","smallTitle","length","projectList","background","tableTitles","map","index","intents","post","picture","width","picture_url","borderRadius","published","color","status","message","substring","createDate","lastUpdate","idPost","idPage","margin","logs","checkComments","noLogs","backgroundColor","noAgents","mapStateToProps","socialMediaR","fbData","instaData","agentsR","agentsSelectedProject"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\n\r\nimport Pages from '../Pages/Pages';\r\n\r\nimport {\r\n    Col,\r\n    Row,\r\n    Image,\r\n    Modal,\r\n} from 'react-bootstrap';\r\nimport ReactTooltip from 'react-tooltip';\r\nimport moment from 'moment';\r\nimport axios from 'axios';\r\nimport { host } from '../../../config';\r\nimport Swal from 'sweetalert2/dist/sweetalert2.js';\r\nimport Lottie from 'react-lottie';\r\nimport { useHistory, useLocation  } from 'react-router-dom';\r\n\r\nimport { connect } from 'react-redux';\r\nimport {  resetSocialMediaSelections,sycroPageWithWizard } from '../../../redux/actions/socialMediaActions';\r\nimport { resetَAllWizard, } from '../../../redux/actions/wizardActions';\r\nimport {  getProjectByPage, goToWizardConfig, deleteProjectByPage, setAgentsSelectedProject, resetLogs  } from '../../../redux/actions/myAgentsActions';\r\n\r\n// Translations\r\nimport { trans } from '../../../Translations';\r\n\r\nimport notFoundAnimationData from '../../../assets/json/not-found.json';\r\nimport { FaLink } from 'react-icons/fa';\r\nimport { AiFillPicture } from 'react-icons/ai';\r\nimport { BiError } from 'react-icons/bi';\r\nimport { IoIosClose } from 'react-icons/io';\r\nimport { FaInfoCircle } from 'react-icons/fa';\r\n\r\nconst EDIT_ICON = require('../../../assets/images/home/Icon feather-edit.svg');\r\nconst MSG_ICON = require('../../../assets/images/home/Icon feather-message-square.svg');\r\nconst TRASH_ICON = require('../../../assets/images/home/trash-simple.svg');\r\n\r\nfunction MyAgents(props) {\r\n\r\n    let {\r\n        lang,\r\n        allSocialPages,\r\n        socialMediaPageSelected,\r\n        agentsProjects,\r\n        \r\n        // Functions\r\n        sycroPageWithWizard,\r\n        resetَAllWizard,\r\n        resetSocialMediaSelections,\r\n        resetLogs,\r\n        getProjectByPage,\r\n        goToWizardConfig,\r\n        deleteProjectByPage,\r\n        setAgentsSelectedProject\r\n    } = props;\r\n\r\n    // Popup Config:\r\n    const swalWithBootstrapButtons = Swal.mixin({ customClass: {confirmButton: 'wizard-pages-active-btn-alert'}, buttonsStyling: false });\r\n    \r\n    const notFoundOptions = {\r\n        loop: true,\r\n        autoplay: true, \r\n        animationData: notFoundAnimationData,\r\n        rendererSettings: {\r\n          preserveAspectRatio: 'xMidYMid slice'\r\n        }\r\n    };\r\n\r\n    let history = useHistory();\r\n    let location = useLocation();\r\n\r\n    // const tableTitles = ['Picture', 'Publish', 'Message', 'Date', 'Last update', 'Type', 'Status', 'Edit project'];\r\n\r\n    // State :\r\n    const [deleteProjectModal, setDeleteProjectModal] = useState(false);\r\n    const [projectToDelete, setProjectToDelete] = useState({});\r\n    // const [activatingProject, setActivatingProject] = useState({status: \"\", index: null});\r\n    const [showPopover, setShowPopover] = useState(false);\r\n\r\n    const confirmDeleteModal = () => (\r\n        <Modal show={deleteProjectModal} centered>\r\n            <Modal.Body>\r\n                <Col lg={12}>\r\n                    <Row>\r\n                        <Col lg={12} className=\"d-flex\">\r\n                        <IoIosClose color={\"#B4B4B4\"} size={30} className=\"ml-auto\" style={{cursor: 'pointer'}} onClick={() => { setProjectToDelete({}); setDeleteProjectModal(false); }} />\r\n                        </Col>\r\n        \r\n                        <Col lg={12} className=\"d-flex\">\r\n                        <BiError color={\"#E5007D\"} size={65} className=\"mx-auto mb-3\" style={{cursor: 'pointer'}} />\r\n                        </Col>\r\n        \r\n                        <Col lg={12} className=\"d-flex\">\r\n                        <p className=\"mx-auto mb-2 confirm-modal-text\">{trans[lang].myAgents.deleteProject}</p>\r\n                        </Col>\r\n                    \r\n                        <Col lg={12} className=\"d-flex\">\r\n                        <div className=\"mx-auto mb-3 manage-products-add-btn d-flex text-center\" onClick={() => deleteProjectByPage(projectToDelete).then(() => { setProjectToDelete({}); setDeleteProjectModal(false); })}>\r\n                            <p className=\"m-auto\">{trans[lang].myAgents.confirmDelete}</p>\r\n                        </div>\r\n                        </Col>\r\n        \r\n                        <Col lg={12} className=\"d-flex\">\r\n                        <p className=\"mx-auto mb-2 cancel-btn-modal-text\" onClick={() => { setProjectToDelete({}); setDeleteProjectModal(false); }}>{trans[lang].myAgents.rejectDelete}</p>\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n            </Modal.Body>\r\n        </Modal>\r\n    );\r\n\r\n    const renderDate = (date) => {\r\n        return moment(date).format('DD/MM/YY');\r\n    };\r\n\r\n    const renderTime = (date) => {\r\n        return moment(date).format('h:mm');\r\n    };\r\n\r\n    const checkStatusClass = (trained,live) => {\r\n    \r\n        if (trained && live) {\r\n            // ACTIVE\r\n            return \"my-agent-status-btn d-flex\"\r\n\r\n        } else if (trained && !live) {\r\n            // !NOT ACTIVE\r\n             return \"my-agent-status-btn d-flex\"\r\n        } else {\r\n            // DRAFT\r\n            return \"my-agent-status-btn-disabled d-flex\"\r\n        }\r\n    };\r\n\r\n    const activateAgentNow = (project,indexProject) => {\r\n\r\n        // console.log(\"To Activate that =>\", project);\r\n\r\n        if (project.trained && project.live) {\r\n            // MAKE IT NOT ACTIVE\r\n            let objectToSend = {\r\n                live : false\r\n            };\r\n\r\n            axios.put(host + `/api/v1/secure/project/agent/live/${project._id}`,objectToSend,{\r\n                headers: {\r\n                    'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n                }\r\n            })\r\n            .then(res => {\r\n                console.log('agent Later post APi Response =>', res.data.data);\r\n                getProjectByPage(socialMediaPageSelected);\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"agent Later post Api error  =>\", err)\r\n                swalWithBootstrapButtons.fire({ title: `Error while activating agent. Try Again !`,confirmButtonText: 'Okay' });\r\n            })\r\n\r\n        } else if (project.trained && !project.live) {\r\n            // ACTIVATE IT\r\n            let objectToSend = {\r\n                live : true\r\n            };\r\n            \r\n            axios.put(host + `/api/v1/secure/project/agent/live/${project._id}`,objectToSend,{\r\n                headers: {\r\n                    'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n                }\r\n            })\r\n            .then(res => {\r\n                console.log('My agents agent/live post APi Response =>', res.data.data);\r\n                getProjectByPage(socialMediaPageSelected);\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"My agents agent/live Api error  =>\", err)\r\n                swalWithBootstrapButtons.fire({ title: `Error while activating agent. Try Again !`,confirmButtonText: 'Okay' });\r\n            })\r\n        } else {\r\n            // DRAFT\r\n            return;\r\n        }\r\n    };\r\n\r\n    const renderPopover = () => (\r\n        <div className=\"d-flex manage-products-popover\">\r\n          <p className=\"m-auto\">\r\n            {trans[lang].myAgents.infoPopover}\r\n            {/* <br/> */}\r\n            {/* <a href=\"\">learn more</a> */}\r\n          </p>\r\n        </div>\r\n    );\r\n      \r\n    const handlePopover = (delay) => {\r\n        setTimeout( () => {\r\n          setShowPopover(!showPopover);\r\n        },delay)\r\n    };\r\n\r\n    useEffect(() => {\r\n        resetَAllWizard();\r\n        resetLogs();\r\n        if(location.state) {\r\n            if(location.state.hasOwnProperty('imFrom') && location.state.hasOwnProperty('page') && allSocialPages) {\r\n                // Sync with the wizard page\r\n                // console.log(\"Lets syncro with the wizard :D\", location.state);\r\n                sycroPageWithWizard(allSocialPages,location.state.page);\r\n            } \r\n        } \r\n    },[]);\r\n\r\n    useEffect(() => {\r\n        if(socialMediaPageSelected) {\r\n            getProjectByPage(socialMediaPageSelected);\r\n        }\r\n    },[socialMediaPageSelected]);\r\n\r\n    return (\r\n    <div style={{ height: window.innerHeight * 2, marginTop: '135px' }}>\r\n        {/* MODAL DELETE PROJECT */}\r\n        {deleteProjectModal && confirmDeleteModal()}\r\n        \r\n        <Row className=\"mt-5\">\r\n          <p className=\"home-big-title\">{trans[lang].myAgents.title}</p>\r\n          <FaInfoCircle style={{transitionDuration: '300ms' }} color={!showPopover ? \"#4080FF\" : \"#E5007D\"} size={'15'} onMouseEnter={() => handlePopover('20')} onMouseLeave={() => handlePopover('300')} />\r\n          {showPopover && renderPopover()}\r\n        </Row>\r\n\r\n        <Pages title={trans[lang].myAgents.smallTitle} />\r\n\r\n        {props.socialMediaPageSelected && \r\n        agentsProjects && agentsProjects.length > 0\r\n        ?\r\n        <>\r\n        <Row>\r\n            <Col lg={12}>\r\n                <Row className=\"mb-2 mx-0\">\r\n\r\n                    <Col lg={12} className=\"d-flex mb-0\">\r\n                        <p className=\"my-auto my-agent-table-title\">{trans[lang].myAgents.projectList}</p>\r\n                    </Col>\r\n            \r\n                    <Col lg={11} className=\"my-3 mx-0 p-0\">\r\n                        <Row>\r\n                            <Col lg={12} className=\"pl-4 pr-5 py-4\" style={{background: \"#FFFFFF\"}}>\r\n                                <Row className=\"py-2 justify-content-between\">\r\n                                    {trans[lang].myAgents.tableTitles.map((title,index) => (\r\n                                        <Col lg={ title === \"Status\" || title === \"Message\" || title === \"Statut\"  ? 2 :  1} key={index} className=\"d-flex p-0\">\r\n                                            <div className=\"m-auto my-agent-title-table\" >{title}</div>\r\n                                        </Col>    \r\n                                    ))}   \r\n                                </Row>  \r\n                                \r\n                                {/* PROJECTS */}\r\n                                {agentsProjects && \r\n                                agentsProjects.map((project,indexProject) => \r\n                                    project.hasOwnProperty('intents') && project.intents.length > 0\r\n                                    && \r\n                                    <Row key={indexProject} className=\"py-2 justify-content-between\" >  \r\n                                        <Col lg={1} className=\"d-flex\">\r\n                                            {project.post.picture \r\n                                            ?\r\n                                            <Image src={project.post.picture} className={\"m-auto\"} style={{height: '40px', width: '40px'}} />\r\n                                            :\r\n                                            <Image src={socialMediaPageSelected.picture_url} className={\"m-auto\"} style={{height: '40px', width: '40px', borderRadius: '50%'}} />\r\n                                            }\r\n                                        </Col>    \r\n\r\n                                        <Col lg={1} className=\"d-flex\">\r\n                                            {project.post.published\r\n                                            ?\r\n                                            <div className=\"flex-column\">\r\n                                                <p className=\"m-auto my-agent-project-date\"  style={{color: project.post.status === \"Scheduled\" ? \"#009EE3\" : \"#4D4F5C\"}}>{renderDate(project.post.published)}</p>\r\n                                                <p  className=\"m-auto my-agent-project-time\" style={{color: project.post.status === \"Scheduled\" ? \"#009EE3\" : \"#4D4F5C\"}}>{renderTime(project.post.published)}</p>\r\n                                            </div>\r\n                                            :\r\n                                            <p className=\"mx-auto my-agent-project-date\">--.--</p>\r\n                                            }\r\n                                        </Col>    \r\n\r\n                                        <Col lg={2} className=\"d-flex p-0\" >\r\n                                            {project.post.message \r\n                                            ?\r\n                                            <div className=\"m-auto my-agents-msg-desc\" >\r\n                                                {project.post.message.length > 12\r\n                                                ?\r\n                                                project.post.message.substring(0,40) + \"...\"\r\n                                                :\r\n                                                project.post.message\r\n                                                }\r\n                                            </div>\r\n                                            :\r\n                                            <p className=\"mx-auto my-agent-project-date\">--.--</p>\r\n                                            }\r\n                                        </Col>    \r\n\r\n                                        <Col lg={1} className=\"d-flex\" >\r\n                                            <div className=\"flex-column\">\r\n                                                <p className=\"m-auto my-agent-project-date\">{renderDate(project.createDate)}</p>\r\n                                                <p  className=\"m-auto my-agent-project-time\">{renderTime(project.createDate)}</p>\r\n                                            </div>\r\n                                        </Col>\r\n                                        \r\n                                        <Col lg={1} className=\"d-flex\" >\r\n                                            <div className=\"flex-column\">\r\n                                                <p className=\"m-auto my-agent-project-date\">{renderDate(project.lastUpdate)}</p>\r\n                                                <p  className=\"m-auto my-agent-project-time\">{renderTime(project.lastUpdate)}</p>\r\n                                            </div>\r\n                                        </Col>\r\n\r\n                                        <Col lg={1} className=\"d-flex\" >\r\n                                            <div className=\"m-auto wizard-pages-page-title-table\" >\r\n                                                {project.post.idPost === project.post.page.idPage\r\n                                                ?\r\n                                                <FaLink color={project.post.published != null ? \"#B4B4B4\" : \"#85ADFF\"} size={\"22\"} className=\"m-auto\" />\r\n                                                :\r\n                                                <AiFillPicture color={project.post.published != null ? \"#B4B4B4\" : \"#85ADFF\"} size={\"22\"} className=\"m-auto\" />\r\n                                                }\r\n                                            </div>\r\n                                        </Col>    \r\n\r\n                                        <Col lg={2} className=\"d-flex\">\r\n                                            <div className={checkStatusClass(project.trained,project.live)}  onClick={() => activateAgentNow(project,indexProject)} style={{margin: 'auto'}} >\r\n                                                {\r\n                                                project.trained && project.live \r\n                                                ? \r\n                                                <p className=\"m-auto\">Active</p> \r\n                                                : \r\n                                                project.trained && !project.live\r\n                                                ? \r\n                                                <p className=\"m-auto\">Not Active</p>\r\n                                                :\r\n                                                <p className=\"m-auto\">Draft</p>\r\n                                                }\r\n                                            </div>\r\n                                        </Col>   \r\n\r\n                                        <Col lg={1} className=\"d-flex\">\r\n                                            <Image src={EDIT_ICON}  data-for='editIcon' data-tip={\"Update agent\"} className={\"my-auto ml-auto my-agents-icon\"}  style={{ height: '19px', width: '19px'}} onClick={() => goToWizardConfig(project,socialMediaPageSelected,history)} />\r\n                                            <Image src={MSG_ICON}   data-for='commentsIcon' data-tip={project.logs === 1 ? trans[lang].myAgents.checkComments : trans[lang].myAgents.noLogs} className={\"mx-2 my-auto my-agents-icon\"} style={{ height: '19px', width: '19px'}} onClick={() => project.logs === 1 && setAgentsSelectedProject(project,history) } />\r\n                                            <Image src={TRASH_ICON} data-for='deleteIcon' data-tip={\"Delete agent\"} className={\"my-auto mr-auto my-agents-icon\"}  style={{ height: '19px', width: '19px'}}  onClick={() => {setProjectToDelete(project); setDeleteProjectModal(true); }} />\r\n                                            \r\n                                            <ReactTooltip id='editIcon'     className='my-agent-icons-hover-text' textColor='#fff' backgroundColor='#B4B4B4' />\r\n                                            <ReactTooltip id='commentsIcon' className='my-agent-icons-hover-text' textColor='#fff' backgroundColor='#B4B4B4' />\r\n                                            <ReactTooltip id='deleteIcon'   className='my-agent-icons-hover-text' textColor='#fff' backgroundColor='#B4B4B4' />\r\n                                        </Col>    \r\n                                    </Row>  \r\n                                )}\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n\r\n                </Row>\r\n            </Col>\r\n        </Row>\r\n        </>\r\n        :\r\n        <>\r\n        <Col lg={12} className=\"d-flex\" style={{backgroundColor: '#F9F9F9' }}>\r\n            <Lottie options={notFoundOptions} width={200} className=\"m-auto\" /*height={400}*/ />\r\n        </Col>\r\n\r\n        <Col lg={12} className=\"d-flex mt-5\" style={{backgroundColor: '#F9F9F9' }}>\r\n            <p className=\"m-auto home-big-title\">{trans[lang].myAgents.noAgents}</p>\r\n        </Col>\r\n        </>\r\n        }\r\n\r\n    </div>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        lang : state.socialMediaR.lang,\r\n        fbData : state.socialMediaR.fbData,\r\n        instaData : state.socialMediaR.instaData,\r\n        allSocialPages : state.socialMediaR.allSocialPages,\r\n        socialMediaPageSelected : state.socialMediaR.socialMediaPageSelected,\r\n        agentsProjects: state.agentsR.agentsProjects,\r\n        agentsSelectedProject: state.agentsR.agentsSelectedProject,\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, { resetSocialMediaSelections, sycroPageWithWizard, getProjectByPage, goToWizardConfig, resetَAllWizard, deleteProjectByPage, setAgentsSelectedProject, resetLogs  })(MyAgents);\r\n\r\n"]},"metadata":{},"sourceType":"module"}