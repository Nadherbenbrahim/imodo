{"ast":null,"code":"import _slicedToArray from\"/usr/work/smart_front_oussema/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import axios from'axios';import{host}from'../../../config';import{connect}from'react-redux';import{nextSpecificWizardStep,testAgent,resetStep4ReceivedMsg,getExistingProject}from'../../../redux/actions/wizardActions';import{Row,Col,Image,Spinner,Popover}from'react-bootstrap';import{withRouter}from'react-router-dom';// Translations\nimport{trans}from'../../../Translations';import Swal from'sweetalert2/dist/sweetalert2.js';import Keyboard from'react-simple-keyboard';import layout from\"simple-keyboard-layouts/build/layouts/arabic\";import ReactTooltip from'react-tooltip';var Arabic=require('../../../assets/images/home/Arabic.svg');var Arabic_Active=require('../../../assets/images/home/arabic01.svg');var LETTER_ICON=require('../../../assets/images/home/3a.png');var IMODO_PROFILE_ICON=require('../../../assets/images/home/full-bulle-imodo.png');export var WizardTest=function WizardTest(props){var lang=props.lang,wizardIntentType=props.wizardIntentType,wizardSelectedPage=props.wizardSelectedPage,wizardSelectedPost=props.wizardSelectedPost,wizardReceivedMsg=props.wizardReceivedMsg,wizardIdProject=props.wizardIdProject,wizardExistingProject=props.wizardExistingProject,history=props.history,resetStep4ReceivedMsg=props.resetStep4ReceivedMsg,nextSpecificWizardStep=props.nextSpecificWizardStep,getExistingProject=props.getExistingProject;// Popup Config:\nvar swalWithBootstrapButtons=Swal.mixin({customClass:{confirmButton:'wizard-pages-active-btn-alert'},buttonsStyling:false});var keyboard=useRef(null);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),sendedMsg=_useState4[0],setSendedMsg=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),btnLoading=_useState6[0],setBtnLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),wizardFinish=_useState8[0],setWizardFinish=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showKeyboard=_useState10[0],setShowKeyboard=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),cursorPos=_useState12[0],setCursorPos=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),activateAgent=_useState14[0],setActivateAgent=_useState14[1];// Tags:\n// const [Tags,setTags] = useState(false);\nvar TagsPopover=/*#__PURE__*/React.createElement(Popover,{id:\"popover-tags\"},/*#__PURE__*/React.createElement(Popover.Content,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,{className:\"pl-1 my-2\"},/*#__PURE__*/React.createElement(Col,{xs:12,className:\"d-flex mb-1 mt-2\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto mr-auto wizard-config-tag\",onClick:function onClick(){setMessage(function(prevMsg){return prevMsg+'##FIRST_NAME##';});}},trans[lang].wizardMiracleInput.firstName)),/*#__PURE__*/React.createElement(Col,{xs:12,className:\"d-flex mb-1\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto mr-auto wizard-config-tag\",onClick:function onClick(){setMessage(function(prevMsg){return prevMsg+'##LAST_NAME##';});}},trans[lang].wizardMiracleInput.lastName)),/*#__PURE__*/React.createElement(Col,{xs:12,className:\"d-flex mb-1\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto mr-auto wizard-config-tag\",onClick:function onClick(){setMessage(function(prevMsg){return prevMsg+'##FULL_NAME##';});}},trans[lang].wizardMiracleInput.fullName)),/*#__PURE__*/React.createElement(Col,{xs:12,className:\"m-auto d-flex mb-2\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto mr-auto wizard-config-tag\",onClick:function onClick(){setMessage(function(prevMsg){return prevMsg+'##PAGE_NAME##';});}},trans[lang].wizardMiracleInput.pageName)))))));var chat=function chat(){props.testAgent(message,wizardIntentType,wizardSelectedPage,wizardSelectedPost).then(function(){setSendedMsg(message);setMessage('');}).catch(function(err){console.log(\"Getting test message wizard\",err);swalWithBootstrapButtons.fire({title:trans[lang].wizardTest.errGetMsg,confirmButtonText:trans[lang].wizardTest.retry});});};var showTheFinish=function showTheFinish(){setBtnLoading(true);setTimeout(function(){setWizardFinish(true);setBtnLoading(null);},1500);};var activateAgentNow=function activateAgentNow(status){if(status==='live'){var objectToSend={live:true};axios.put(host+\"/api/v1/secure/project/agent/live/\".concat(wizardIdProject),objectToSend,{headers:{'authorization':'Bearer '+localStorage.getItem('authtoken')}}).then(function(res){console.log('agent Live post APi Response =>',res.data.data);// history.push('/home/my-agents');\nhistory.push({pathname:'/home/my-agents',state:{imFrom:'Wizard',page:wizardSelectedPage}});}).catch(function(err){console.log(\"agent Live post Api error  =>\",err);swalWithBootstrapButtons.fire({title:trans[lang].wizardTest.errActivAgent,confirmButtonText:trans[lang].wizardTest.retry});});}else{var _objectToSend={live:false};axios.put(host+\"/api/v1/secure/project/agent/live/\".concat(wizardIdProject),_objectToSend,{headers:{'authorization':'Bearer '+localStorage.getItem('authtoken')}}).then(function(res){console.log('agent Later post APi Response =>',res.data.data);// history.push('/home/my-agents');\nhistory.push({pathname:'/home/my-agents',state:{imFrom:'Wizard',page:wizardSelectedPage}});}).catch(function(err){console.log(\"agent Later post Api error  =>\",err);swalWithBootstrapButtons.fire({title:trans[lang].wizardTest.errActivAgent,confirmButtonText:trans[lang].wizardTest.retry});});}};var backToStep3=function backToStep3(){// Reset Msg received & Go:\nresetStep4ReceivedMsg();nextSpecificWizardStep(2);};var handleCursorPosition=function handleCursorPosition(e){// console.log(\"Code\", e.keyCode, \"cursor in\", e.target.selectionStart);\nsetCursorPos(e.target.selectionStart-1);};var isProjectActive=function isProjectActive(project){if(project.trained&&project.live){return true;// Status === Active\n// Put your set State ya haider\n}else if(project.trained&&!project.live){return false;// Status === Not Active\n// Put your set State ya haider\n}else{return false;// Status === DRAFT\n// Put your set State ya haider\n}};useEffect(function(){resetStep4ReceivedMsg();if(wizardIdProject){getExistingProject(wizardIdProject);};if(wizardExistingProject){setActivateAgent(isProjectActive(wizardExistingProject));};},[]);return/*#__PURE__*/React.createElement(Row,{className:\"mt-5\"},/*#__PURE__*/React.createElement(Col,{lg:1}),/*#__PURE__*/React.createElement(Col,{lg:9,className:\"wizard-pages-container mb-3\",style:{backgroundColor:'white'}},/*#__PURE__*/React.createElement(Row,{className:\"d-flex mt-4 ml-2 mb-4\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-auto wizard-pages-title\"},trans[lang].wizardTest.testInteractionTitle)),/*#__PURE__*/React.createElement(Row,{className:\"mb-4\"},/*#__PURE__*/React.createElement(Col,{lg:9,className:\"mx-auto\",style:{backgroundColor:'white',borderRadius:'0.2rem',border:'1px solid #B4B4B4',height:wizardReceivedMsg&&wizardReceivedMsg.length>1?\"auto\":'300px'}},sendedMsg===null&&/*#__PURE__*/React.createElement(Row,{className:\"d-flex\",style:{height:'100%'}},/*#__PURE__*/React.createElement(Col,{lg:12,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto wizard-posts-status-text\"},trans[lang].wizardTest.testInteraction))),sendedMsg!==null&&/*#__PURE__*/React.createElement(Row,{className:\"d-flex\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Row,{className:\"my-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(\"div\",{className:\"my-agents-msgs-bulle mb-1\"},/*#__PURE__*/React.createElement(\"p\",{className:\"my-agents-msgs-bulle-text\"},sendedMsg))))),/*#__PURE__*/React.createElement(Col,{lg:7})),wizardReceivedMsg&&wizardReceivedMsg.length>0&&wizardReceivedMsg.map(function(msg,index){return msg.response.text===\"\"?/*#__PURE__*/React.createElement(Row,{key:index,className:\"d-flex\"},/*#__PURE__*/React.createElement(Col,{lg:6}),/*#__PURE__*/React.createElement(Col,{lg:6},/*#__PURE__*/React.createElement(Row,{className:\"my-3\"},/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,{className:\"justify-content-end\"},/*#__PURE__*/React.createElement(Col,{lg:10,className:\"px-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"my-agents-msgs-bulle-bleu mb-1\",style:{backgroundColor:'#3B86FF'}},/*#__PURE__*/React.createElement(\"p\",{className:\"my-agents-msgs-bulle-text\",style:{color:'white'}},trans[lang].wizardTest.didNotUnderstand))),/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex pl-1\"},/*#__PURE__*/React.createElement(Image,{src:IMODO_PROFILE_ICON,className:\"mt-auto\",style:{maxWidth:'50px'}}))))))):/*#__PURE__*/React.createElement(Row,{key:index,className:\"d-flex\"},/*#__PURE__*/React.createElement(Col,{lg:6}),/*#__PURE__*/React.createElement(Col,{lg:6},/*#__PURE__*/React.createElement(Row,{className:\"my-3\"},/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,{className:\"justify-content-end\"},/*#__PURE__*/React.createElement(Col,{lg:10,className:\"px-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"my-agents-msgs-bulle-bleu mb-1\",style:{backgroundColor:'#3B86FF'}},/*#__PURE__*/React.createElement(\"p\",{className:\"my-agents-msgs-bulle-text\",style:{color:'white'}},msg.response.text))),/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex pl-1\"},/*#__PURE__*/React.createElement(Image,{src:IMODO_PROFILE_ICON,className:\"mt-auto\",style:{maxWidth:'50px'}})))),/*#__PURE__*/React.createElement(Col,{lg:12},/*#__PURE__*/React.createElement(Row,{className:\"justify-content-end\"},/*#__PURE__*/React.createElement(Col,{lg:10,className:\"px-0\"},msg.response.hasOwnProperty('buttons')&&msg.response.buttons.length<2?msg.response.buttons.map(function(btn,ind){return/*#__PURE__*/React.createElement(\"div\",{key:ind,\"data-for\":\"btnTip\",\"data-tip\":btn.type===\"web_url\"?btn.url:btn.payload,className:\"button-message-facebook d-flex mb-1\"},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},btn.title));}):/*#__PURE__*/React.createElement(\"div\",{className:\"group-btns-facebook\"},msg.response.buttons.map(function(btn,ind){return/*#__PURE__*/React.createElement(\"div\",{key:ind,\"data-for\":\"btnTip\",\"data-tip\":btn.type===\"web_url\"?btn.url:btn.payload,className:\"btn-group-facebook\".concat(ind,\" d-flex\"),style:{borderBottom:ind<msg.response.buttons.length-1&&\"1px solid #caccd2\"}},/*#__PURE__*/React.createElement(\"p\",{className:\"m-auto\"},btn.title));})),/*#__PURE__*/React.createElement(ReactTooltip,{id:\"btnTip\",textColor:\"#fff\",backgroundColor:\"#E5007D\"})),/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex pl-1\"}))))));}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3 mb-3\"},/*#__PURE__*/React.createElement(Col,{lg:9,className:\"mx-auto\",style:{backgroundColor:'white',borderRadius:'0.2rem',border:'1px solid #B4B4B4'}},/*#__PURE__*/React.createElement(Row,{className:\"pt-4 pb-4\"},/*#__PURE__*/React.createElement(Col,{lg:1},/*#__PURE__*/React.createElement(Row,{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex m-auto\"},/*#__PURE__*/React.createElement(Image,{src:showKeyboard?Arabic_Active:Arabic,onClick:function onClick(){return setShowKeyboard(!showKeyboard);},className:\"my-auto my-agents-msgs-tiny-icon\"})),showKeyboard&&/*#__PURE__*/React.createElement(\"div\",{className:\"wizard-config-keyboard-container\",style:{marginLeft:'20px',marginTop:\"-235px\"}},/*#__PURE__*/React.createElement(Keyboard,{keyboardRef:function keyboardRef(r){keyboard.current=r;keyboard.current.setInput(message);},onChange:function onChange(input){return setMessage(input);},onKeyPress:function onKeyPress(key){return key===\"{enter}\"&&setShowKeyboard(false);},layout:layout})))),/*#__PURE__*/React.createElement(Col,{lg:11,className:\"d-flex p-0\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"my-auto wizard-test-input w-100\",placeholder:trans[lang].wizardTest.msgPlaceholder,value:message,onChange:function onChange(e){setMessage(e.target.value);if(keyboard.current){keyboard.current.setInput(e.target.value);}},onClick:function onClick(e){return setCursorPos(e.target.selectionStart);},onKeyDown:function onKeyDown(e){return e.key==='Enter'&&chat();}})),/*#__PURE__*/React.createElement(Col,{lg:3})))),/*#__PURE__*/React.createElement(Row,{className:\"d-flex justify-content-between pl-4 pr-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wizard-pages-inactive-btn py-2 px-4 mb-3\",onClick:function onClick(){return backToStep3();}},trans[lang].wizardTest.back),/*#__PURE__*/React.createElement(\"div\",{className:\"mb-3\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"wizard-pages-inactive-btn py-2 px-4 mr-3\"},trans[lang].wizardTest.saveDraft),/*#__PURE__*/React.createElement(\"div\",{className:\"wizard-pages-active-btn py-2 px-4 mr-3\",onClick:function onClick(){return showTheFinish();}},btnLoading?/*#__PURE__*/React.createElement(Spinner,{size:\"sm\",animation:\"border\",variant:\"light\"}):trans[lang].wizardTest.finish))))),wizardFinish&&/*#__PURE__*/React.createElement(Col,{lg:2,className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mt-auto mb-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"finish-test-container d-flex flex-column py-3 mb-5\"},/*#__PURE__*/React.createElement(\"button\",{className:activateAgent?\"mx-auto finish-test-white-btn mb-2\":\"mx-auto finish-test-white-btn-active mb-2\",onClick:function onClick(){return activateAgentNow('live');}},wizardExistingProject&&wizardExistingProject.hasOwnProperty('published')&&wizardExistingProject.published?trans[lang].wizardTest.updateNow:trans[lang].wizardTest.activateNow),/*#__PURE__*/React.createElement(\"button\",{className:activateAgent?\"mx-auto finish-test-transparent-btn mb-2\":\"mx-auto finish-test-transparent-btn-active mb-2\",onClick:function onClick(){return activateAgentNow('later');}},wizardExistingProject&&wizardExistingProject.hasOwnProperty('published')&&wizardExistingProject.published?trans[lang].wizardTest.updateLater:trans[lang].wizardTest.activateLater)))));};var mapStateToProps=function mapStateToProps(state){return{lang:state.socialMediaR.lang,wizardStep:state.wizardR.wizardStep,wizardIntentType:state.wizardR.wizardIntentType,wizardSelectedPage:state.wizardR.wizardSelectedPage,wizardSelectedPost:state.wizardR.wizardSelectedPost,wizardReceivedMsg:state.wizardR.wizardReceivedMsg,wizardIdProject:state.wizardR.wizardIdProject,wizardExistingProject:state.wizardR.wizardExistingProject};};export default withRouter(connect(mapStateToProps,{nextSpecificWizardStep:nextSpecificWizardStep,testAgent:testAgent,resetStep4ReceivedMsg:resetStep4ReceivedMsg,getExistingProject:getExistingProject})(WizardTest));","map":{"version":3,"sources":["/usr/work/smart_front_oussema/src/app/Home/AutoWizard/WizardTest.js"],"names":["React","useState","useEffect","useRef","axios","host","connect","nextSpecificWizardStep","testAgent","resetStep4ReceivedMsg","getExistingProject","Row","Col","Image","Spinner","Popover","withRouter","trans","Swal","Keyboard","layout","ReactTooltip","Arabic","require","Arabic_Active","LETTER_ICON","IMODO_PROFILE_ICON","WizardTest","props","lang","wizardIntentType","wizardSelectedPage","wizardSelectedPost","wizardReceivedMsg","wizardIdProject","wizardExistingProject","history","swalWithBootstrapButtons","mixin","customClass","confirmButton","buttonsStyling","keyboard","message","setMessage","sendedMsg","setSendedMsg","btnLoading","setBtnLoading","wizardFinish","setWizardFinish","showKeyboard","setShowKeyboard","cursorPos","setCursorPos","activateAgent","setActivateAgent","TagsPopover","prevMsg","wizardMiracleInput","firstName","lastName","fullName","pageName","chat","then","catch","err","console","log","fire","title","wizardTest","errGetMsg","confirmButtonText","retry","showTheFinish","setTimeout","activateAgentNow","status","objectToSend","live","put","headers","localStorage","getItem","res","data","push","pathname","state","imFrom","page","errActivAgent","backToStep3","handleCursorPosition","e","target","selectionStart","isProjectActive","project","trained","backgroundColor","testInteractionTitle","borderRadius","border","height","length","testInteraction","map","msg","index","response","text","color","didNotUnderstand","maxWidth","hasOwnProperty","buttons","btn","ind","type","url","payload","borderBottom","marginLeft","marginTop","r","current","setInput","input","key","msgPlaceholder","value","back","saveDraft","finish","published","updateNow","activateNow","updateLater","activateLater","mapStateToProps","socialMediaR","wizardStep","wizardR"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport axios from 'axios';\r\nimport { host } from '../../../config';\r\n\r\nimport { connect } from 'react-redux';\r\nimport { nextSpecificWizardStep, testAgent, resetStep4ReceivedMsg, getExistingProject } from '../../../redux/actions/wizardActions';\r\n\r\nimport {\r\n    Row,\r\n    Col,\r\n    Image,\r\n    Spinner,\r\n    Popover,\r\n} from 'react-bootstrap';\r\n\r\nimport {\r\n    withRouter,\r\n} from 'react-router-dom';\r\n\r\n// Translations\r\nimport { trans } from '../../../Translations';\r\n\r\n\r\nimport Swal from 'sweetalert2/dist/sweetalert2.js';\r\nimport Keyboard from 'react-simple-keyboard';\r\nimport layout from \"simple-keyboard-layouts/build/layouts/arabic\";\r\nimport ReactTooltip from 'react-tooltip';\r\n\r\nconst Arabic = require('../../../assets/images/home/Arabic.svg');\r\nconst Arabic_Active = require('../../../assets/images/home/arabic01.svg');\r\nconst LETTER_ICON = require('../../../assets/images/home/3a.png');\r\nconst IMODO_PROFILE_ICON = require('../../../assets/images/home/full-bulle-imodo.png');\r\n\r\nexport const WizardTest = (props) => {\r\n\r\n    let {\r\n        lang,\r\n        wizardIntentType,\r\n        wizardSelectedPage,\r\n        wizardSelectedPost,\r\n        wizardReceivedMsg,\r\n        wizardIdProject,\r\n        wizardExistingProject,\r\n        history,\r\n\r\n        resetStep4ReceivedMsg,\r\n        nextSpecificWizardStep,\r\n        getExistingProject,\r\n    } = props;\r\n\r\n    // Popup Config:\r\n    const swalWithBootstrapButtons = Swal.mixin({ customClass: {confirmButton: 'wizard-pages-active-btn-alert'}, buttonsStyling: false });\r\n\r\n    const keyboard = useRef(null);\r\n\r\n\r\n    const [message,setMessage] = useState('');\r\n    const [sendedMsg,setSendedMsg] = useState(null);\r\n    const [btnLoading,setBtnLoading] = useState(null);\r\n    const [wizardFinish,setWizardFinish] = useState(null);\r\n    const [showKeyboard, setShowKeyboard] = useState(false);\r\n    const [cursorPos, setCursorPos] = useState(0);\r\n    const [activateAgent, setActivateAgent] = useState(null);\r\n\r\n    \r\n    // Tags:\r\n    // const [Tags,setTags] = useState(false);\r\n    \r\n    const TagsPopover = (\r\n        <Popover id=\"popover-tags\">\r\n          <Popover.Content>\r\n            <Row>\r\n                <Col lg={12}>\r\n                    <Row className=\"pl-1 my-2\">\r\n                        <Col xs={12} className=\"d-flex mb-1 mt-2\">\r\n                            <p className=\"my-auto mr-auto wizard-config-tag\" onClick={() => { setMessage(prevMsg => prevMsg + '##FIRST_NAME##'); }}>{trans[lang].wizardMiracleInput.firstName}</p>\r\n                        </Col>\r\n                         \r\n                        <Col xs={12} className=\"d-flex mb-1\">\r\n                            <p className=\"my-auto mr-auto wizard-config-tag\" onClick={() => { setMessage(prevMsg => prevMsg + '##LAST_NAME##'); }}>{trans[lang].wizardMiracleInput.lastName}</p>\r\n                        </Col>\r\n\r\n                        <Col xs={12} className=\"d-flex mb-1\">\r\n                            <p className=\"my-auto mr-auto wizard-config-tag\" onClick={() => { setMessage(prevMsg => prevMsg + '##FULL_NAME##'); }}  >{trans[lang].wizardMiracleInput.fullName}</p>\r\n                        </Col>\r\n\r\n                        <Col xs={12} className=\"m-auto d-flex mb-2\">\r\n                            <p className=\"my-auto mr-auto wizard-config-tag\" onClick={() => { setMessage(prevMsg => prevMsg + '##PAGE_NAME##'); }}  >{trans[lang].wizardMiracleInput.pageName}</p>\r\n                        </Col> \r\n                    </Row>\r\n                </Col>\r\n            </Row>\r\n          </Popover.Content>\r\n        </Popover>\r\n    );\r\n\r\n    const chat = () => {\r\n        props.testAgent(message,wizardIntentType,wizardSelectedPage,wizardSelectedPost)\r\n        .then(() => {\r\n            setSendedMsg(message);\r\n            setMessage('');\r\n        })\r\n        .catch(err => {\r\n            console.log(\"Getting test message wizard\", err);\r\n\r\n            swalWithBootstrapButtons.fire({\r\n                title: trans[lang].wizardTest.errGetMsg,\r\n                confirmButtonText: trans[lang].wizardTest.retry,\r\n            });\r\n        });\r\n    };\r\n\r\n    const showTheFinish = () => {\r\n        setBtnLoading(true);\r\n\r\n        setTimeout(() => {\r\n            setWizardFinish(true);\r\n            setBtnLoading(null);\r\n        },1500);\r\n    };\r\n\r\n    const activateAgentNow = (status) => {\r\n\r\n        if(status === 'live') {\r\n\r\n            let objectToSend = {\r\n                live : true\r\n            };\r\n\r\n            axios.put(host + `/api/v1/secure/project/agent/live/${wizardIdProject}`,objectToSend,{\r\n                headers: {\r\n                    'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n                }\r\n            })\r\n            .then(res => {\r\n                console.log('agent Live post APi Response =>', res.data.data);\r\n                // history.push('/home/my-agents');\r\n                history.push({\r\n                    pathname: '/home/my-agents',\r\n                    state: { imFrom : 'Wizard', page: wizardSelectedPage },\r\n                });\r\n                \r\n            })\r\n            .catch((err) => {\r\n                console.log(\"agent Live post Api error  =>\", err)\r\n                swalWithBootstrapButtons.fire({ title: trans[lang].wizardTest.errActivAgent,confirmButtonText: trans[lang].wizardTest.retry });\r\n            })\r\n            \r\n        } else {\r\n\r\n            let objectToSend = {\r\n                live : false\r\n            };\r\n\r\n            axios.put(host + `/api/v1/secure/project/agent/live/${wizardIdProject}`,objectToSend,{\r\n                headers: {\r\n                    'authorization': 'Bearer ' + localStorage.getItem('authtoken')\r\n                }\r\n            })\r\n            .then(res => {\r\n                console.log('agent Later post APi Response =>', res.data.data);\r\n                // history.push('/home/my-agents');\r\n                history.push({\r\n                    pathname: '/home/my-agents',\r\n                    state: { imFrom : 'Wizard', page: wizardSelectedPage },\r\n                });\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"agent Later post Api error  =>\", err)\r\n                swalWithBootstrapButtons.fire({ title: trans[lang].wizardTest.errActivAgent,confirmButtonText: trans[lang].wizardTest.retry });\r\n            })\r\n        }\r\n\r\n    };\r\n\r\n    const backToStep3 = () => {\r\n        // Reset Msg received & Go:\r\n        resetStep4ReceivedMsg();\r\n        nextSpecificWizardStep(2)\r\n    };\r\n\r\n    const handleCursorPosition = (e) => {\r\n        // console.log(\"Code\", e.keyCode, \"cursor in\", e.target.selectionStart);\r\n        setCursorPos(e.target.selectionStart - 1);\r\n    }\r\n\r\n    const isProjectActive = (project) => {\r\n      \r\n        if(project.trained && project.live) {\r\n            return true; // Status === Active\r\n            // Put your set State ya haider\r\n\r\n        } else if (project.trained && !project.live) {\r\n            return false // Status === Not Active\r\n            // Put your set State ya haider\r\n\r\n        } else {\r\n            return false // Status === DRAFT\r\n            // Put your set State ya haider\r\n\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n            \r\n        resetStep4ReceivedMsg();\r\n        if(wizardIdProject) {\r\n            getExistingProject(wizardIdProject)\r\n        };\r\n\r\n        if(wizardExistingProject) {\r\n            setActivateAgent(isProjectActive(wizardExistingProject))\r\n        };\r\n\r\n    },[])\r\n\r\n    return (\r\n        <Row className=\"mt-5\">  \r\n            <Col lg={1} />\r\n    \r\n            <Col lg={9} className=\"wizard-pages-container mb-3\" style={{backgroundColor: 'white'}}>\r\n                \r\n                <Row className=\"d-flex mt-4 ml-2 mb-4\">\r\n                    <p className=\"my-auto wizard-pages-title\">{trans[lang].wizardTest.testInteractionTitle}</p>\r\n                </Row>\r\n                \r\n                <Row className=\"mb-4\">\r\n                    <Col lg={9} className=\"mx-auto\" style={{backgroundColor : 'white',borderRadius: '0.2rem',border: '1px solid #B4B4B4', height: wizardReceivedMsg && wizardReceivedMsg.length > 1 ? \"auto\" : '300px' }}>\r\n                        {sendedMsg === null\r\n                        &&\r\n                        <Row className=\"d-flex\" style={{height: '100%'}}>\r\n                            <Col lg={12} className=\"d-flex\" >\r\n                                <p className=\"m-auto wizard-posts-status-text\">{trans[lang].wizardTest.testInteraction}</p>\r\n                            </Col>\r\n                        </Row>\r\n                        }\r\n\r\n                        {/* BULLE GRIS */}\r\n                        {sendedMsg !== null &&\r\n                        <Row className=\"d-flex\">\r\n                            <Col>\r\n                                <Row className=\"my-3\">\r\n                                    <Col>\r\n                                        <div className=\"my-agents-msgs-bulle mb-1\">\r\n                                            <p className=\"my-agents-msgs-bulle-text\">\r\n                                               {sendedMsg}\r\n                                            </p>\r\n                                        </div>\r\n                                        {/* <p className=\"my-agents-msgs-bulle-date\">1 hour ago</p> */}\r\n                                    </Col>\r\n                                </Row>\r\n                            </Col>\r\n\r\n                            <Col lg={7} />\r\n                        </Row>\r\n                        }\r\n\r\n                        {/* BULLE BLEU */}\r\n                        {wizardReceivedMsg && wizardReceivedMsg.length > 0\r\n                        &&\r\n                        wizardReceivedMsg.map((msg,index) => \r\n                            msg.response.text === \"\"\r\n                            ?\r\n                            <Row key={index} className=\"d-flex\">\r\n                                <Col lg={6} />\r\n\r\n                                <Col lg={6}>\r\n                                    <Row className=\"my-3\">\r\n                                        <Col lg={12}>\r\n                                            <Row className=\"justify-content-end\">\r\n                                                <Col lg={10} className=\"px-0\">\r\n                                                    <div className=\"my-agents-msgs-bulle-bleu mb-1\" style={{backgroundColor: '#3B86FF'}}>\r\n                                                        <p className=\"my-agents-msgs-bulle-text\" style={{color: 'white'}}>\r\n                                                            {trans[lang].wizardTest.didNotUnderstand}\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </Col>\r\n                                                <Col lg={2} className=\"d-flex pl-1\">\r\n                                                    <Image src={IMODO_PROFILE_ICON} className={\"mt-auto\"} style={{maxWidth: '50px'}} />\r\n                                                </Col>\r\n                                            </Row>\r\n                                            {/* <p className=\"my-agents-msgs-bulle-date\">1 hour ago</p> */}\r\n                                        </Col>\r\n                                    </Row>\r\n                                </Col>\r\n                            </Row>\r\n                            :\r\n                            <Row key={index} className=\"d-flex\">\r\n                                <Col lg={6} />\r\n\r\n                                <Col lg={6}>\r\n                                    <Row className=\"my-3\">\r\n                                        <Col lg={12}>\r\n                                            <Row className=\"justify-content-end\">\r\n                                                <Col lg={10} className=\"px-0\">\r\n                                                    <div className=\"my-agents-msgs-bulle-bleu mb-1\" style={{backgroundColor: '#3B86FF'}}>\r\n                                                        <p className=\"my-agents-msgs-bulle-text\" style={{color: 'white'}}>\r\n                                                            {msg.response.text}\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </Col>\r\n                                                <Col lg={2} className=\"d-flex pl-1\">\r\n                                                    <Image src={IMODO_PROFILE_ICON} className={\"mt-auto\"} style={{maxWidth: '50px'}} />\r\n                                                </Col>\r\n                                            </Row>\r\n                                            {/* <p className=\"my-agents-msgs-bulle-date\">1 hour ago</p> */}\r\n                                        </Col>\r\n\r\n                                        {/* BUTTONS */}\r\n                                        <Col lg={12}>\r\n                                            <Row className=\"justify-content-end\">\r\n                                                <Col lg={10} className=\"px-0\">\r\n                                                    {msg.response.hasOwnProperty('buttons') && msg.response.buttons.length < 2\r\n                                                    ?\r\n                                                    msg.response.buttons.map((btn,ind) => \r\n                                                    <div key={ind} data-for='btnTip' data-tip={btn.type === \"web_url\" ? btn.url : btn.payload} className=\"button-message-facebook d-flex mb-1\">\r\n                                                        <p className=\"m-auto\">{btn.title}</p>\r\n                                                    </div>\r\n                                                    )\r\n                                                    :\r\n                                                    <div className=\"group-btns-facebook\">\r\n                                                        {msg.response.buttons.map((btn,ind) => \r\n                                                        <div key={ind} data-for='btnTip' data-tip={btn.type === \"web_url\" ? btn.url : btn.payload} className={`btn-group-facebook${ind} d-flex`} style={{borderBottom: ind < msg.response.buttons.length - 1 && \"1px solid #caccd2\" }}>\r\n                                                            <p className=\"m-auto\">{btn.title}</p>\r\n                                                        </div>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    }\r\n                                                    <ReactTooltip id='btnTip' textColor='#fff' backgroundColor='#E5007D' />\r\n                                                </Col>\r\n\r\n                                                <Col lg={2} className=\"d-flex pl-1\">\r\n                                                    {/* <Image src={IMODO_PROFILE_ICON} className={\"mt-auto\"} style={{maxWidth: '50px'}} /> */}\r\n                                                </Col>\r\n                                            </Row>\r\n                                        </Col>\r\n                                        \r\n                                        {/* <Col lg={12}>\r\n                                            <Row className=\"justify-content-end\">\r\n                                                <Col lg={10} className=\"px-0\">\r\n                                                    {msg.response.hasOwnProperty('buttons') && msg.response.buttons.length > 1\r\n                                                    &&\r\n                                                    <div className=\"group-btns-facebook\">\r\n                                                        {msg.response.buttons.map((btn,ind) => \r\n                                                        <div key={ind} data-for='btnTip' data-tip={btn.type === \"web_url\" ? btn.url : btn.payload} className={`btn-group-facebook${ind} d-flex`} style={{borderBottom: ind < msg.response.buttons.length - 1 && \"1px solid #caccd2\" }}>\r\n                                                            <p className=\"m-auto\">{btn.title}</p>\r\n                                                        </div>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    }\r\n                                                    <ReactTooltip id='btnTip' textColor='#fff' backgroundColor='#E5007D' />\r\n                                                </Col>\r\n\r\n                                                <Col lg={2} className=\"d-flex pl-1\"/>\r\n                                       \r\n                                            </Row>\r\n                                        </Col> */}\r\n\r\n                                    </Row>\r\n                                </Col>\r\n                            </Row>\r\n                        )}\r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row className=\"mt-3 mb-3\">\r\n                    <Col lg={9} className=\"mx-auto\" style={{backgroundColor : 'white',borderRadius: '0.2rem',border: '1px solid #B4B4B4'}}>\r\n                        <Row className=\"pt-4 pb-4\">\r\n                            <Col lg={1}>\r\n                                {/* NADIA REMOVED TAGS & EMOJIS FROM THE TEST */}\r\n                                {/* <Row className=\"justify-content-around\"> */}\r\n                                <Row className=\"d-flex\">\r\n                                    {/* <div className=\"d-flex\">\r\n                                        <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={TagsPopover}>\r\n                                            <Image \r\n                                                src={Tags ? BALISE_ICON_ACTIVE : BALISE_ICON} \r\n                                                onClick={() => setTags(!Tags)} \r\n                                                className=\"my-auto mr-auto my-agents-msgs-tiny-icon\" \r\n                                                style={{ width: '19px', cursor: 'pointer'}} \r\n                                            />   \r\n                                        </OverlayTrigger> \r\n                                    </div>                                \r\n\r\n                                    <div className=\"d-flex\">\r\n                                        <Image src={EMO_ICON} className=\"m-auto my-agents-msgs-tiny-icon\" />\r\n                                    </div> */}\r\n\r\n                                    <div className=\"d-flex m-auto\">\r\n                                        <Image src={showKeyboard ? Arabic_Active  : Arabic} onClick={() => setShowKeyboard(!showKeyboard)} className=\"my-auto my-agents-msgs-tiny-icon\" />\r\n                                    </div>\r\n\r\n                                    {showKeyboard &&\r\n                                        <div className=\"wizard-config-keyboard-container\" style={{marginLeft: '20px', marginTop: \"-235px\"}}>\r\n                                            <Keyboard \r\n                                                keyboardRef={r => {keyboard.current = r; keyboard.current.setInput(message);}}\r\n                                                onChange={(input) => setMessage(input)}\r\n                                                onKeyPress={(key) => key === \"{enter}\" && setShowKeyboard(false)}\r\n                                                layout={layout} \r\n                                            />\r\n                                        </div>\r\n                                    }\r\n                                </Row>\r\n                            </Col>\r\n\r\n                            <Col lg={11} className=\"d-flex p-0\">\r\n                                <input \r\n                                    type=\"text\" \r\n                                    className=\"my-auto wizard-test-input w-100\" \r\n                                    placeholder={trans[lang].wizardTest.msgPlaceholder}\r\n                                    value={message}\r\n                                    onChange={(e) => { setMessage(e.target.value); if(keyboard.current) { keyboard.current.setInput(e.target.value); } }} \r\n                                    onClick={(e) => setCursorPos(e.target.selectionStart)}\r\n                                    onKeyDown={(e) => e.key === 'Enter' && chat()}\r\n                                />\r\n                            </Col>\r\n\r\n                            <Col lg={3} />    \r\n\r\n                        </Row>\r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row className=\"d-flex justify-content-between pl-4 pr-4\">\r\n                    <div className=\"wizard-pages-inactive-btn py-2 px-4 mb-3\" onClick={() => backToStep3()}>\r\n                        {trans[lang].wizardTest.back}\r\n                    </div>\r\n\r\n                    <div className=\"mb-3\">\r\n                        <Row>\r\n                            <div className=\"wizard-pages-inactive-btn py-2 px-4 mr-3\">\r\n                                {trans[lang].wizardTest.saveDraft}\r\n                            </div>\r\n\r\n                            <div className={\"wizard-pages-active-btn py-2 px-4 mr-3\"} onClick={() => showTheFinish()}>\r\n                                {\r\n                                btnLoading\r\n                                ?\r\n                                (<Spinner size=\"sm\" animation=\"border\" variant=\"light\" />)\r\n                                :\r\n                                trans[lang].wizardTest.finish\r\n                                }\r\n                            </div>\r\n                        </Row>\r\n                    </div>\r\n                </Row>\r\n\r\n            </Col>\r\n    \r\n            {wizardFinish \r\n            &&    \r\n            <Col lg={2} className=\"d-flex\">\r\n                <div className=\"mt-auto mb-5\">\r\n                    <div className=\"finish-test-container d-flex flex-column py-3 mb-5\">\r\n                        <button className={activateAgent ? \"mx-auto finish-test-white-btn mb-2\" : \"mx-auto finish-test-white-btn-active mb-2\"} onClick={() => activateAgentNow('live')}>\r\n                            {wizardExistingProject && wizardExistingProject.hasOwnProperty('published') && wizardExistingProject.published ?  trans[lang].wizardTest.updateNow :  trans[lang].wizardTest.activateNow }\r\n                        </button>\r\n                        <button className={activateAgent ? \"mx-auto finish-test-transparent-btn mb-2\" : \"mx-auto finish-test-transparent-btn-active mb-2\"} onClick={() => activateAgentNow('later')}>\r\n                            {wizardExistingProject && wizardExistingProject.hasOwnProperty('published') && wizardExistingProject.published ?  trans[lang].wizardTest.updateLater : trans[lang].wizardTest.activateLater }\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </Col>\r\n            }\r\n        </Row>\r\n        )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    lang: state.socialMediaR.lang,\r\n    wizardStep: state.wizardR.wizardStep,\r\n    wizardIntentType: state.wizardR.wizardIntentType,\r\n    wizardSelectedPage: state.wizardR.wizardSelectedPage,\r\n    wizardSelectedPost: state.wizardR.wizardSelectedPost,\r\n    wizardReceivedMsg: state.wizardR.wizardReceivedMsg,\r\n    wizardIdProject: state.wizardR.wizardIdProject,\r\n    wizardExistingProject: state.wizardR.wizardExistingProject,\r\n});\r\n\r\nexport default withRouter(connect(mapStateToProps, { nextSpecificWizardStep, testAgent, resetStep4ReceivedMsg, getExistingProject })(WizardTest));"]},"metadata":{},"sourceType":"module"}